stats<- computeStats(dataf,dataf$Answer.confidence,"All Answers - confidence");
## Computes a table with statistics for each difficulty or confidence level
computeStats<- function(df,selection, filterName){
dataframe <- data.frame(Confidence=double(),Accuracy=double(), Precision=double(), Recall=double(), Answers=double() );
for(i in 1:5){
outcomesDF<- selectOutcomes(df,selection==i);
dataframe[i,1]<-c(i);
dataframe[i,2]<-computeAccuracy(outcomesDF);
dataframe[i,3]<-computePrecision(outcomesDF);
dataframe[i,4]<-computeRecall(outcomesDF);
dataframe[i,5]<-sum(outcomesDF[1,]);
}
print(filterName);
print(dataframe);
message("Total answers:" , sum(dataframe$Answers));
return(dataframe);
}
stats<- computeStats(dataf,dataf$Answer.confidence,"All Answers - confidence");
ggplot(stats, aes(x=Confidence, y=Accuracy~Recall)) +
geom_line() +
ggtitle("Metrics for all answers");
ggplot(stats, aes(x=Confidence, y=Recall)) +
geom_line() +
ggtitle("Metrics for all answers");
ggplot(stats, aes(x=Confidence, y=Accuracy~Recall)) +
geom_line() +
ggtitle("Metrics for all answers");
library("reshape2");
metrics<- melt(stats, id.vars="Metrics", value.name="Accuracy", variable.name="Precision", variable.name="Recall");
metrics<- melt(stats, id.vars="Metrics", value.name="%", variable.name="Confidence");
metrics<- melt(stats, id.vars="Metrics", value.name="%", variable.name="Confidence");
metrics<- melt(stats, id.vars="Confidence", value.name="%", variable.name="Confidence");
metrics
metrics<- melt(stats, id.vars="Confidence", value.name="%", variable.name="Metric");
metrics
ggplot(metrics, aes(x=Confidence, group=Metrics)) +
geom_line() +
ggtitle("Metrics for all answers");
ggplot(metrics, aes(x=Confidence, group=Metric)) +
geom_line() +
ggtitle("Metrics for all answers");
ggplot(metrics, aes(x=Confidence, group=Confidence)) +
geom_line() +
ggtitle("Metrics for all answers");
ggplot(metrics, aes(x=Confidence, group=Confidence)) +
geom_line() +
ggtitle("Metrics for all answers");
ggplot(metrics, aes(x=Confidence,y=%, group=Confidence)) +
geom_line() +
ggtitle("Metrics for all answers");
metrics<- melt(stats, id.vars="Confidence", value.name="level", variable.name="Metric");
ggplot(metrics, aes(x=Confidence,y=level, group=Confidence)) +
geom_line() +
ggtitle("Metrics for all answers");
ggplot(metrics, aes(x=Confidence,y=level, group=Metric)) +
geom_line() +
ggtitle("Metrics for all answers");
stats1<- computeStats(dataf,dataf$Answer.confidence,"All Answers - confidence");
ggplot(stats1, aes(x=Confidence)) +
geom_line(aes(y = Accuracy), colour="blue") +
geom_line(aes(y = Precision), colour = "grey") +
ggtitle("Metrics for all answers");
ggplot(stats1, aes(x=Confidence)) +
geom_line(aes(y = Accuracy), colour="blue") +
geom_line(aes(y = Precision), colour = "red") +
geom_line(aes(y = Recall), colour = "black") +
ggtitle("Metrics for all answers");
ggplot(stats1, aes(x=Confidence)) +
geom_line(aes(y = Accuracy), colour="blue") +
geom_line(aes(y = Precision), colour = "red") +
geom_line(aes(y = Recall), colour = "black") +
ggtitle("Metrics for all answers")
ylab(label="Metrics") +
xlab("Confidence");
ggplot(stats1, aes(x=Confidence)) +
geom_line(aes(y = Accuracy), colour="blue") +
geom_line(aes(y = Precision), colour = "red") +
geom_line(aes(y = Recall), colour = "black") +
ggtitle("Metrics for all answers")+
ylab(label="Metrics") +
xlab("Confidence");
ggplot(stats1, aes(x=Confidence)) +
geom_line(aes(y = Accuracy), colour="blue") +
geom_line(aes(y = Precision), colour = "red") +
geom_line(aes(y = Recall), colour = "black") +
ggtitle("Metrics for all answers")+
ylab(label="Metrics") +
xlab("Confidence")+
guides(fill=TRUE);
ggplot(stats1, aes(x=Confidence)) +
geom_line(aes(y = Accuracy), colour="blue") +
geom_line(aes(y = Precision), colour = "red") +
geom_line(aes(y = Recall), colour = "black") +
ggtitle("Metrics for all answers")+
ylab(label="Metrics") +
xlab("Confidence")+
scale_fill_discrete(guide=TRUE);
ggplot(stats1, aes(x=Confidence),fill="Metrics") +
geom_line(aes(y = Accuracy), colour="blue") +
geom_line(aes(y = Precision), colour = "red") +
geom_line(aes(y = Recall), colour = "black") +
ggtitle("Metrics for all answers")+
ylab(label="Metrics") +
xlab("Confidence");
ggplot(stats1, aes(x=Confidence),fill="Metrics") +
geom_line(aes(y = Accuracy), colour="blue") +
geom_line(aes(y = Precision), colour = "red") +
geom_line(aes(y = Recall), colour = "black") +
ggtitle("Metrics for all answers")+
ylab(label="Metrics") +
xlab("Confidence")+
scale_colour_manual("",
breaks = stats1$Confidence,
values = c("blue", "red", "black"));
ggplot(stats1, aes(x=Confidence),fill="Metrics") +
geom_line(aes(y = Accuracy), colour="Accuracy") +
geom_line(aes(y = Precision), colour = "Precision") +
geom_line(aes(y = Recall), colour = "Recall") +
ggtitle("Metrics for all answers")+
ylab(label="Metrics") +
xlab("Confidence")+
scale_colour_manual("",
breaks =c("Accuracy","Precision","Recall"),
values = c("blue", "red", "black"));
ggplot(stats1, aes(x=Confidence),fill="Metrics") +
geom_line(aes(y = Accuracy), colour="Accuracy") +
geom_line(aes(y = Precision), colour = "Precision") +
geom_line(aes(y = Recall), colour = "Recall") +
ggtitle("Metrics for all answers")+
ylab(label="Metrics") +
xlab("Confidence")+
scale_colour_manual("",
values =c("Accuracy"="blue","Precision"="red","Recall"="black"));
ggplot(stats1, aes(x=Confidence),fill="Metrics") +
geom_line(aes(y = Accuracy), colour="Accuracy") +
geom_line(aes(y = Precision), colour = "Precision") +
geom_line(aes(y = Recall), colour = "Recall") +
ggtitle("Metrics for all answers")+
ylab(label="Metrics") +
xlab("Confidence")+
scale_colour_manual("",
breaks =c("Accuracy" ,"Precision" ,"Recall"),
values =c("Accuracy"="blue","Precision"="red","Recall"="black"));
ggplot(stats1, aes(x=Confidence),fill="Metrics") +
geom_line(aes(y = Accuracy, colour="Accuracy")) +
geom_line(aes(y = Precision, colour = "Precision")) +
geom_line(aes(y = Recall, colour = "Recall")) +
ggtitle("Metrics for all answers")+
ylab(label="Metrics") +
xlab("Confidence")+
scale_colour_manual("",
breaks =c("Accuracy" ,"Precision" ,"Recall"),
values =c("Accuracy"="blue","Precision"="red","Recall"="black"));
ggplot(stats1, aes(x=Confidence),fill="Metrics") +
geom_line(aes(y = Accuracy, colour="Accuracy")) +
geom_line(aes(y = Precision, colour = "Precision")) +
geom_line(aes(y = Recall, colour = "Recall")) +
ggtitle("Metrics for all answers")+
ylab(label="Metrics") +
xlab("Confidence")+
scale_colour_manual("",
breaks =c("Accuracy" ,"Precision" ,"Recall"),
values =c("blue","red","black"));
ggplot(stats1, aes(x=Confidence),fill="Metrics") +
geom_line(aes(y = Accuracy, colour="Accuracy")) +
geom_line(aes(y = Precision, colour = "Precision")) +
geom_line(aes(y = Recall, colour = "Recall")) +
ggtitle("Metrics for all answers")+
ylab(label="Metrics") +
xlab("Confidence")+
scale_colour_manual("",
values =c("blue","red","black"));
stats
buildPlot <- function(stats){
multiplot <- ggplot(stats1, aes(x=Confidence),fill="Metrics") +
geom_line(aes(y = Accuracy, colour="Accuracy")) +
geom_line(aes(y = Recall, colour = "Recall")) +
geom_line(aes(y = Precision, colour = "Precision")) +
ggtitle("Metrics for all answers")+
ylab(label="Metrics") +
xlab("Confidence")+
scale_colour_manual("",
breaks =c("Accuracy" ,"Precision" ,"Recall"),
values =c("Accuracy"="blue","Precision"="red","Recall"="black"));
return(multiplot)
}
p1<- buildPlot(stats1);
dataYES <- dataf [(dataf$Answer.option=="YES") ,];
stats2<- computeStats(dataYES,dataYES$Answer.confidence,"Only YES Answers - confidence");
## Only NO's
dataNO <- dataf [(dataf$Answer.option=="NO") ,];
stats3<- computeStats(dataNO,dataNO$Answer.confidence,"Only NO Answers - confidence");
multiplot(p1, p2, p3, cols=2)
p1<- buildPlot(stats1);
p2<- buildPlot(stats2);
p3<- buildPlot(stats3);
multiplot(p1, p2, p3, cols=2)
source("C://Users//chris//OneDrive//Documentos//GitHub//correlation_graphs//multiplot.R");
source("C://Users//chris//OneDrive//Documentos//GitHub//photinus-analytics//correlation_graphs//multiplot.R");
source("C://Users//chris//OneDrive//Documentos//GitHub//photinus-analytics//correlationGraphs//multiplot.R");
p1<- buildPlot(stats1);
p2<- buildPlot(stats2);
p3<- buildPlot(stats3);
multiplot(p1, p2, p3, cols=2);
## Builds plots with multiple lines
buildPlot <- function(stats){
multiplot <- ggplot(stats, aes(x=Confidence),fill="Metrics") +
geom_line(aes(y = Accuracy, colour="Accuracy")) +
geom_line(aes(y = Recall, colour = "Recall")) +
geom_line(aes(y = Precision, colour = "Precision")) +
ggtitle("Metrics for all answers")+
ylab(label="Metrics") +
xlab("Confidence")+
scale_colour_manual("",
breaks =c("Accuracy" ,"Precision" ,"Recall"),
values =c("Accuracy"="blue","Precision"="red","Recall"="black"));
return(multiplot)
}
p1<- buildPlot(stats1);
p2<- buildPlot(stats2);
p3<- buildPlot(stats3);
multiplot(p1, p2, p3, cols=2);
dataYES <- dataf [(dataf$Answer.option=="YES") ,];
stats2<- computeStats(dataYES,dataYES$Answer.confidence,"Only YES Answers - confidence");
stats1<- computeStats(dataf,dataf$Answer.confidence,"All Answers - confidence");
dataNO <- dataf [(dataf$Answer.option=="NO") ,];
stats3<- computeStats(dataNO,dataNO$Answer.confidence,"Only NO Answers - confidence");
dataProf <- dataf [(dataf$Worker.profession=="Professional_Developer") ,];
stats<- computeStats(dataProf,dataProf$Answer.confidence,"Only PROFESSIONAL_DEVELOPERS - confidence");
dataYES <- dataf [(dataf$Answer.option=="YES") ,];
stats2<- computeStats(dataYES,dataYES$Answer.confidence,"Only YES Answers - confidence");
dataNO <- dataf [(dataf$Answer.option=="NO") ,];
stats3<- computeStats(dataNO,dataNO$Answer.confidence,"Only NO Answers - confidence");
## Builds plots with multiple lines
buildPlot <- function(stats){
multiplot <- ggplot(stats, aes(x=Confidence),fill="Metrics") +
geom_line(aes(y = Accuracy, colour="Accuracy")) +
geom_line(aes(y = Recall, colour = "Recall")) +
geom_line(aes(y = Precision, colour = "Precision")) +
ggtitle("Metrics for all answers")+
ylab(label="Metrics") +
xlab("Confidence")+
scale_colour_manual("",
breaks =c("Accuracy" ,"Recall","Precision"),
values =c("Accuracy"="blue","Recall"="black","Precision"="red"));
return(multiplot)
}
p1<- buildPlot(stats1);
p2<- buildPlot(stats2);
p3<- buildPlot(stats3);
multiplot(p1, p2, p3, cols=2);
## Builds plots with multiple lines
buildPlot <- function(stats){
multiplot <- ggplot(stats, aes(x=Confidence),fill="Metrics") +
geom_line(aes(y = Accuracy, colour="Accuracy")) +
geom_line(aes(y = Recall, colour = "Recall")) +
geom_line(aes(y = Precision, colour = "Precision")) +
ggtitle("Metrics for all answers")+
ylab(label="Metrics") +
xlab("Confidence")+
scale_colour_manual("",
breaks =c("Accuracy" ,"Recall","Precision"),
values =c("blue","black","red"));
return(multiplot)
}
## Builds plots with multiple lines
buildPlot <- function(stats){
multiplot <- ggplot(stats, aes(x=Confidence),fill="Metrics") +
geom_line(aes(y = Accuracy, colour="Accuracy")) +
geom_line(aes(y = Recall, colour = "Recall")) +
geom_line(aes(y = Precision, colour = "Precision")) +
ggtitle("Metrics for all answers")+
ylab(label="Metrics") +
xlab("Confidence")+
scale_colour_manual("",
values =c("blue","black","red"));
return(multiplot)
}
p1<- buildPlot(stats1);
p2<- buildPlot(stats2);
p3<- buildPlot(stats3);
multiplot(p1, p2, p3, cols=2);
buildPlot <- function(stats){
multiplot <- ggplot(stats, aes(x=Confidence),fill="Metrics") +
geom_line(aes(y = Accuracy, colour="Accuracy")) +
geom_line(aes(y = Recall, colour = "Recall")) +
geom_line(aes(y = Precision, colour = "Precision")) +
ggtitle("Metrics for all answers")+
ylab(label="Metrics") +
xlab("Confidence")+
scale_colour_manual("",
values =c("Accuracy"="blue","Recall"="black","Precision"="red"));
return(multiplot)
}
p1<- buildPlot(stats1);
p2<- buildPlot(stats2);
p3<- buildPlot(stats3);
multiplot(p1, p2, p3, cols=2);
## Builds plots with multiple lines
buildPlot <- function(stats){
multiplot <- ggplot(stats, aes(x=Confidence),fill="Metrics") +
geom_line(aes(y = Accuracy, colour="Accuracy")) +
geom_line(aes(y = Recall, colour = "Recall")) +
geom_line(aes(y = Precision, colour = "Precision")) +
ggtitle("Metrics for all answers")+
ylab(label="Metrics") +
xlab("Confidence")+
scale_colour_manual("",
breaks =c("Accuracy" ,"Recall","Precision"),
values =c("Accuracy"="blue","Recall"="black","Precision"="red"));
return(multiplot)
}
buildPlot <- function(stats){
multiplot <- ggplot(stats, aes(x=Confidence),fill="Metrics") +
geom_line(aes(y = Accuracy, colour="Accuracy")) +
geom_line(aes(y = Recall, colour = "Recall")) +
geom_line(aes(y = Precision, colour = "Precision")) +
ggtitle("Metrics for all answers")+
ylab(label="Metrics") +
xlab("Confidence")+
scale_colour_manual("",
breaks =c("Accuracy" ,"Recall","Precision"),
values =c("Accuracy"="blue","Recall"="black","Precision"="red"));
return(multiplot);
}
# breaks =c("Accuracy" ,"Recall","Precision")
p1<- buildPlot(stats1);
p2<- buildPlot(stats2);
p3<- buildPlot(stats3);
multiplot(p1, p2, p3, cols=2);
stats3<- computeStats(dataNO,dataNO$Answer.confidence,"Only NO Answers - confidence");
nonan<-c(NaN,NaN)
nonan
index<-is.nan(nonan)
index
nonan[index]<-0;
nonan
computePrecision<- function(df){
result<-(df$TP)/(df$TP+df$FP);
if(is.nan(sum(result)){
index<- is.NaN(result);
result[index]<-0;
}
return(result);
}
computePrecision<- function(df){
result<-(df$TP)/(df$TP+df$FP);
if(is.nan(sum(result))){
index<- is.NaN(result);
result[index]<-0;
}
return(result);
}
stats1<- computeStats(dataf,dataf$Answer.confidence,"All Answers - confidence");
dataYES <- dataf [(dataf$Answer.option=="YES") ,];
stats2<- computeStats(dataYES,dataYES$Answer.confidence,"Only YES Answers - confidence");
dataNO <- dataf [(dataf$Answer.option=="NO") ,];
stats3<- computeStats(dataNO,dataNO$Answer.confidence,"Only NO Answers - confidence");
#Compute precision for each level of difficulty and confidence
computePrecision<- function(df){
result<-(df$TP)/(df$TP+df$FP);
if(is.nan(sum(result))){
index<- is.nan(result);
result[index]<-0;
}
return(result);
}
dataNO <- dataf [(dataf$Answer.option=="NO") ,];
stats3<- computeStats(dataNO,dataNO$Answer.confidence,"Only NO Answers - confidence");
# breaks =c("Accuracy" ,"Recall","Precision")
p1<- buildPlot(stats1);
p2<- buildPlot(stats2);
p3<- buildPlot(stats3);
multiplot(p1, p2, p3, cols=2);
## Builds plots with multiple lines
buildPlot <- function(stats,title){
multiplot <- ggplot(stats, aes(x=Confidence),fill="Metrics") +
geom_line(aes(y = Accuracy, colour="Accuracy")) +
geom_line(aes(y = Recall, colour = "Recall")) +
geom_line(aes(y = Precision, colour = "Precision")) +
ggtitle(Title)+
ylab(label="Metrics") +
xlab("Confidence")+
scale_colour_manual("",
breaks =c("Accuracy" ,"Recall","Precision"),
values =c("Accuracy"="blue","Recall"="black","Precision"="red"));
return(multiplot);
}
# breaks =c("Accuracy" ,"Recall","Precision")
p1<- buildPlot(stats1,"All answers");
p2<- buildPlot(stats2,"Only Yes's");
p3<- buildPlot(stats3,"Only No's");
multiplot(p1, p2, p3, cols=2);
p1<- buildPlot(stats1,"All answers");
p2<- buildPlot(stats2,"Only Yes answers");
p3<- buildPlot(stats3,"Only No answers");
multiplot(p1, p2, p3, cols=2);
buildPlot <- function(stats,title){
multiplot <- ggplot(stats, aes(x=Confidence),fill="Metrics") +
geom_line(aes(y = Accuracy, colour="Accuracy")) +
geom_line(aes(y = Recall, colour = "Recall")) +
geom_line(aes(y = Precision, colour = "Precision")) +
ggtitle(title)+
ylab(label="Metrics") +
xlab("Confidence")+
scale_colour_manual("",
breaks =c("Accuracy" ,"Recall","Precision"),
values =c("Accuracy"="blue","Recall"="black","Precision"="red"));
return(multiplot);
}
# breaks =c("Accuracy" ,"Recall","Precision")
p1<- buildPlot(stats1,"All answers");
p2<- buildPlot(stats2,"Only Yes answers");
p3<- buildPlot(stats3,"Only No answers");
multiplot(p1, p2, p3, cols=2);
stats1<- computeStats(dataf,dataf$Answer.confidence,"All Answers - confidence");
dataYES <- dataf [(dataf$Answer.option=="YES") ,];
stats2<- computeStats(dataYES,dataYES$Answer.confidence,"Only YES Answers - confidence");
dataNO <- dataf [(dataf$Answer.option=="NO") ,];
stats3<- computeStats(dataNO,dataNO$Answer.confidence,"Only NO Answers - confidence");
buildSinglePlot <- function(stats,title){
singlePlot <- ggplot(stats, aes(x=Confidence),fill="Metrics") +
geom_line(aes(y = Accuracy, colour="Accuracy")) +
ggtitle(title) +
ylab(label="Metrics") +
xlab("Confidence") +
scale_colour_manual("",
breaks = c("Accuracy"),
values = c("Accuracy"="blue"));
return(singlePlot);
}
p1<- buildPlot(stats1,"All answers");
p2<- singlePlot(stats2,"Only Yes answers");
p3<- singlePlot(stats3,"Only No answers");
multiplot(p1, p2, p3, cols=2);
buildSinglePlot <- function(stats,title){
singlePlot <- ggplot(stats, aes(x=Confidence),fill="Metrics") +
geom_line(aes(y = Accuracy, colour="Accuracy")) +
ggtitle(title) +
ylab(label="Metrics") +
xlab("Confidence") +
scale_colour_manual("",
breaks = c("Accuracy"),
values = c("Accuracy"="blue"));
return(singlePlot);
}
# breaks =c("Accuracy" ,"Recall","Precision")
p1<- buildPlot(stats1,"All answers");
p2<- singlePlot(stats2,"Only Yes answers");
p3<- singlePlot(stats3,"Only No answers");
multiplot(p1, p2, p3, cols=2);
## Builds plots with multiple lines
plotMultiLine <- function(stats,title){
multiplot <- ggplot(stats, aes(x=Confidence),fill="Metrics") +
geom_line(aes(y = Accuracy, colour="Accuracy")) +
geom_line(aes(y = Recall, colour = "Recall")) +
geom_line(aes(y = Precision, colour = "Precision")) +
ggtitle(title) +
ylab(label="Metrics") +
xlab("Confidence") +
scale_colour_manual("",
breaks = c("Accuracy" ,"Recall","Precision"),
values = c("Accuracy"="blue","Recall"="black","Precision"="red"));
return(multiplot);
}
plotSingleLine <- function(stats,title){
singlePlot <- ggplot(stats, aes(x=Confidence),fill="Metrics") +
geom_line(aes(y = Accuracy, colour="Accuracy")) +
ggtitle(title) +
ylab(label="Metrics") +
xlab("Confidence") +
scale_colour_manual("",
breaks = c("Accuracy"),
values = c("Accuracy"="blue"));
return(singlePlot);
}
# breaks =c("Accuracy" ,"Recall","Precision")
p1<- plotMultiLine(stats1,"All answers");
p2<- plotSingleLine(stats2,"Only Yes answers");
p3<- plotSingleLine(stats3,"Only No answers");
multiplot(p1, p2, p3, cols=2);
## Builds plots with multiple lines
plotMultiLine <- function(stats,title){
multiplot <- ggplot(stats, aes(x=Confidence),fill="Metrics") +
geom_line(aes(y = Accuracy, colour="Accuracy")) +
geom_line(aes(y = Recall, colour = "Recall")) +
geom_line(aes(y = Precision, colour = "Precision")) +
ggtitle(title) +
ylab(label="Metrics") +
xlab("Confidence") +
scale_colour_manual("",
breaks = c("Accuracy" ,"Recall","Precision"),
values = c("Accuracy"="blue","Recall"="black","Precision"="red"))+
scale_y_continuous(limits = c(0, 1));
return(multiplot);
}
plotSingleLine <- function(stats,title){
singlePlot <- ggplot(stats, aes(x=Confidence),fill="Metrics") +
geom_line(aes(y = Accuracy, colour="Accuracy")) +
ggtitle(title) +
ylab(label="Metrics") +
xlab("Confidence") +
scale_colour_manual("",
breaks = c("Accuracy"),
values = c("Accuracy"="blue"))+
scale_y_continuous(limits = c(0, 1));
return(singlePlot);
}
p1<- plotMultiLine(stats1,"All answers");
p2<- plotSingleLine(stats2,"Only Yes answers");
p3<- plotSingleLine(stats3,"Only No answers");
multiplot(p1, p2, p3, cols=2);
